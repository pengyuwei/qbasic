5 COLOR 7
10 WIDTH 40: KEY OFF: CLS : RANDOMIZE TIMER: DIM A(300): DEF FNR (X) = INT(RND(1) * X) + 1
20 DEF SEG = &HB800: K$ = CHR$(219): K1$ = STRING$(30, 219)
30 PRINT K1$: FOR I = 1 TO 19: PRINT K$; SPC(28); K$: NEXT: PRINT K1$
40 FOR I = 1 TO 100: POKE FNR(17) * 80 + FNR(26) * 2 + 82, 254: NEXT
50 AX = 82: AD = 1576: A(72) = -80: A(75) = -2: A(77) = 2: A(80) = 80: POKE AD, 64
60 WHILE TIMER - T < .15: L = A(INP(96)): K = L - K * (L = 0): I$ = INKEY$: WEND: P = AX: T = TIMER
70 P = P + K: Z = PEEK(P): IF Z = 254 THEN 70 ELSE IF Z <> 32 THEN 90
80 POKE AX, 32: AX = AX + K: POKE P, 254: POKE AX, 234
90 IF PEEK(AD - 2) + PEEK(AD + 2) + PEEK(AD + 80) + PEEK(AD - 80) > 800 THEN A$ = "VERY GOOD! You have won!": AL = AD: GOTO 150 ELSE N = 0: Y = FNR(2): ON Y GOSUB 130, 140
100 Z = PEEK(AD + K): IF Z = 234 THEN A$ = "Oh,sorry! Please play again.": AL = AX: GOTO 150
110 IF Z <> 32 THEN Y = 3 - Y: ON Y GOSUB 130, 140: N = 300 - FNR(2) * 200: GOTO 100
120 POKE AD, 32: AD = AD + K: POKE AD, 64: K = 0: GOTO 60
130 K = A(76 + SGN((AX MOD 80) - (AD MOD 80) + N)): RETURN
140 K = A(76 + SGN(INT(AX / 80) - INT(AD / 80) + N) * 4): RETURN
150 I = 420: WHILE I > 320: I = I - 10: SOUND I, 2: POKE AL, I / 10: WEND: PRINT A$
GOTO 5


